---
title: Radiometry
key: t20181008
tags:
  - Graphics
---

翻译自《Realistic Ray Tracing》第十一章的内容，会略微根据自己的理解进行改动。

<!--more-->

（承接前面的章节）在向光线追踪器加入光照之前，我们需要简单地说明一下“光的强弱”到底是指什么。本章将会建立起一套度量光的强弱的机制，称为辐射度学（radiometry）。

## 光子（Photon）

直觉上，辐射度可以从“一大堆光子”的角度来认知，本节就是要说清楚这一语境下光子的含义（当然，不是从物理的角度，而是从计算的角度建立起的简化模型）。光子是一个具有位置、传播方向和波长$\lambda$的光量子，且拥有一个仅与介质的折射率相关的传播速度$c$。光子的频率为$f = c/\lambda$，它不随传播介质的改变而改变。此外，一个光子所携带的能量也是固定的：

$$
q = hf = \frac{hc}{\lambda}
$$

其中$h = 6.63 \times 10^{-34}J$是普朗克常量。

## 光谱能量（Spectral Energy）

一组光子的总能量$Q$可以通过将每个光子的能量$q_i$求和得到，一个随之产生的问题就是：“这些光子的波长可能各不相同，那么该如何表示$Q$在波长上的分布呢？”我们可以把这些光子按波长分类来粗略地回答这个问题，比如用$q[500, 600] = 10.2$表示波长介于$500$nm到$600$nm间的光子的总能量为$10.2J$。如果我们把这个波长区间划分为两个$50$nm，也许会得到$q[500, 550] = 5.2$和$q[550, 600] = 5$，这表明波长位于前$50$nm的光子拥有比波长位于后$50$nm的光子更多的能量。若是我们按$25$nm将这些光子分为四类，也许会得到$q[500, 525] = 2.5$等，以此类推。这种表示方法的好处是直观易懂，缺点是选用的区间大小会严重地影响数值。

一种常用的表示方法是用区间大小去除能量，即不再使用$q[500, 600] = 10.2$，而是写作：

$$
Q_\lambda[500, 600] = \frac{10.2}{100} = 0.12J(nm)^{-1}
$$

这样一来，区间大小对数值的影响被削弱了许多。此时我们自然会想令$\Delta \lambda \to 0$，但尴尬的问题来了——当$\Delta \lambda$足够小时，$Q_\lambda$要么会是$0$，要么会是一个巨大的值，这取决于是否有光子落在该波长区间中。有两种思路可以解除这一困境：一是假设$\lambda$足够小，但尚未小到让光的量子本性显露出来的境地（好尴尬）；二是干脆把光认为是连续的而非由一个个独立的光子构成的，即允许$dQ/d\lambda$的存在。当然，选用哪一种思路不会影响图形学上的计算结果。做实验性研究的人更喜欢第一个思路，即采用一组小而有限的波长区间，因为这样他们才能在实验室中对其进行测量；做理论研究的人则偏爱第二个思路，因为只有这样他们才能愉快地做微积分计算。

$Q_\lambda$的正式名字叫做光谱能量（Spectral energy），它是一个强度量。与能量、长度、质量等广延量相反，强度量可以被看作是某种密度函数，描述了一点附近某种广延量的密度。比如，一些光子中具有某个特定波长的能量可能是$0$，但这一波长附近的光谱能量（能量密度）$Q_\lambda$仍旧是有意义的。再比如，在一个有$25$亿人的国家中，讨论任何一个特定点处的人口都毫无意义，而人口密度——每平方米的人口则有意义，因为它是在一个足够大的区域上计算出来的。如果我们把人口看成是一个连续的量，那么不论实际区域有多小，人口密度都不会像人口那样颗粒化。

直观地说，想象有一台能测量一束光子的能量的传感器，现在我们把一个只允许波长介于$[\lambda - \Delta\lambda/2, \lambda + \Delta\lambda/2]$间的光子通过的过滤装置放在传感器前，若此时传感器探测到的能量是$\Delta q$，那么$\lambda$处的光谱能量就是$Q = \Delta q / \Delta\lambda$。

## 功率（Power）

功率可以用来衡量一个光源产生光能的速率，其标准单位是瓦特W，即$Js^{-1}$。稳定状态下的功率最好理解，但功率是个强度量（产生的能量在时间上的密度），因此即使每时每刻能量的产生都在变化，功率也是良定义的（well defined）。需要注意的是，在现实中，一个100W的灯泡会因为发热而不能达到100W的光能产生速率。我们可以用功率估算光源美妙会发射多少光子——设某100W的灯泡产生波长为500nm的光子，那么每个光子所携带的能量是：

$$
q = \frac{hc}{\lambda} \approxeq 4 \times 10^{-19}J
$$

因此，即使这个灯泡发光效率底下，它每秒也能产生$10^{20}$数量级的光子，这也解释了为什么在图形学中直接模拟摄像机快门和光子来生成图像是不现实的。

与能量类似，我们也对光谱功率（Spectral Power）很有兴趣。光谱功率的单位是$W(nm)^{-1}$惯用标准符号是$\Phi_\lambda$，但图形学文献常常将它简写为$\Phi$。我们可以给上一节结尾处的能量传感器加上一个开放时间为$[t - \Delta t/2, t + \Delta t/2]$的快门，则$t$时$\lambda$处的光谱功率就是$\Phi = \Delta q/(\Delta t\Delta\lambda)$。

## 辐照度（Irradiance）

辐照度（Irradiance）是用来回答问题“有多少光‘击中’了这个点？”的量。当然，这个问题的答案显然是“零”，因此我们又得引入一个密度函数。如果问题中的“点”是指某个表面上的一点，那么使用面积作为密度函数的除数就是自然而然的选择。直观地说，我们之前所使用的传感器有一个较小的面积$\Delta A$，那么它所测得的光谱辐照度将是：

$$
H = \frac{\Delta q}{\Delta A\Delta t\Delta \lambda}
$$

$H$的单位是$Jm^{-2}s^{-1}(nm)^{-1}$，注意并不是$Jm^{-3}s^{-1}$，这是因为SI使用nm作为光的波长单位。

有的图形学文献使用出射辐照度（Radiant Exitance）$E$表示光离开表面的情况，而仅仅用辐照度（Irradiance）表示光入射到表面上的情况，这在一个点既有光来又有光去的语境下非常实用。

## 辐射（Radiance）

辐照度告诉了我们有多少光入射/出射到某个位置，却没有给出这些光是从什么方向来的、要到什么方向去。要想度量我们眼睛所看到的东西，先得弄明白如何度量光的方向。

用来表示方向的“大小”的量被称为立体角（Solid Angle），单位是steradians，取值范围是$[0, 4\pi]$。平面角的定义是单位圆上的弧长，立体角的定义则是单位球面上一块区域的面积。

和前面的情境类似，特定方向上的辐照度肯定是零，但辐照度在立体角上的密度却不一定是零：

$
L = \frac{\Delta H}{\Delta \sigma \cos \theta} = \frac{\Delta q}{\Delta A\cos\theta\Delta\sigma\Delta t\Delta\lambda}
$
